'use strict';

var router = function () {

    var components = {
        dialogs: window.conversationComponent,
        friends: window.friendsComponent
    };

    function Router() {
        var _this = this;

        this.prevComponent;

        // listen nav controls
        window.onpopstate = history.onpushstate = function (e) {
            if (e.state !== null) {
                _this.renderComponent(e.state.component);
            } else {
                _this.renderComponent('blank');
            }
        };
        this.renderComponent = function (componentName) {

            if (this.prevComponent) {
                this.prevComponent.destroy();
            }

            switch (componentName.toLowerCase()) {
                case 'messages':
                    var messages = new components.dialogs();
                    history.pushState({ component: componentName }, componentName, componentName.toLowerCase());
                    this.prevComponent = messages;
                    break;

                case 'friends':
                    var friends = new components.friends();
                    history.pushState({ component: componentName }, componentName, componentName.toLowerCase());
                    this.prevComponent = friends;
                    break;
                case 'blank':
                    this.prevComponent.destroy();
                    break;
            }
        };

        if (window.location.pathname !== '/') {
            var path = window.location.pathname.replace('/', '');
            this.renderComponent(path);
        }
    }

    return Router;
}();